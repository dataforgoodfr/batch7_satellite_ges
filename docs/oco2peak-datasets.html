---

title: Open Stack Swift storage of the project


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/oco2peak-datasets.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/oco2peak-datasets.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Open-Stack-directories-structure-for-OCO-2">Open Stack directories structure for OCO-2<a class="anchor-link" href="#Open-Stack-directories-structure-for-OCO-2"> </a></h2><p>We do not store the original OCO-2 files from NASA.</p>
<ul>
<li>/datasets/oco-2/inventory/ contains all the potential source of emissions : factories, power plants, cities...</li>
<li>/datasets/oco-2/soudings/ contains CSV of the raw features extracted from NASA NC4 files.</li>
<li>/datasets/oco-2/peaks-detected/ contains all the peaks found in the satellite orbit datas.</li>
<li>/datasets/oco-2/peaks-detected-details/ contains one JSON file of the full data for all detected peak</li>
<li>/datasets/oco-2/peaks-and-invent/ contains the peak found with inventory data and search area</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Module-Installation">Module Installation<a class="anchor-link" href="#Module-Installation"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Class-Datasets">Class Datasets<a class="anchor-link" href="#Class-Datasets"> </a></h2><p>Using a config file for credentials</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Datasets" class="doc_header"><code>class</code> <code>Datasets</code><a href="https://github.com/dataforgoodfr/batch7_satellite_ges/tree/master/oco2peak/datasets.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Datasets</code>(<strong><code>config_file</code></strong>)</p>
</blockquote>
<p>Utility class to access the Open Stack Swift storage of the project.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Connection">Connection<a class="anchor-link" href="#Connection"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="s1">&#39;./configs/config.json&#39;</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="n">Datasets</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-a-dataset">Get a dataset<a class="anchor-link" href="#Get-a-dataset"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Level-2-sounding-value-from-OCO-2-satellite">Level 2 sounding value from OCO-2 satellite<a class="anchor-link" href="#Level-2-sounding-value-from-OCO-2-satellite"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;141&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/datasets/oco-2/soudings/&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/soudings/oco2_1410.csv.bz2&#39;, &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/soudings/oco2_1411.csv.bz2&#39;, &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/soudings/oco2_1412.csv.bz2&#39;]
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sounding_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>xco2</th>
      <th>xco2_uncert</th>
      <th>orbit</th>
      <th>windspeed_u</th>
      <th>windspeed_v</th>
      <th>surface_pressure_apriori</th>
      <th>surface_pressure</th>
      <th>altitude</th>
      <th>land_water_indicator</th>
      <th>land_fraction</th>
      <th>tcwv</th>
      <th>tcwv_apriori</th>
      <th>tcwv_uncertainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014100202182405</td>
      <td>-40.574512</td>
      <td>176.451126</td>
      <td>398.752686</td>
      <td>0.395292</td>
      <td>1337</td>
      <td>6.989320</td>
      <td>-5.809829</td>
      <td>978.123352</td>
      <td>974.571838</td>
      <td>179.613159</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>10.485214</td>
      <td>14.339112</td>
      <td>0.067466</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014100202182432</td>
      <td>-40.533489</td>
      <td>176.476425</td>
      <td>397.972046</td>
      <td>0.428197</td>
      <td>1337</td>
      <td>6.823709</td>
      <td>-5.639187</td>
      <td>976.780273</td>
      <td>972.596436</td>
      <td>191.665970</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>9.183766</td>
      <td>14.187885</td>
      <td>0.066358</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014100202182433</td>
      <td>-40.540665</td>
      <td>176.465958</td>
      <td>397.367462</td>
      <td>0.408428</td>
      <td>1337</td>
      <td>6.896306</td>
      <td>-5.694703</td>
      <td>964.528748</td>
      <td>963.135864</td>
      <td>298.211029</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>8.928223</td>
      <td>13.654849</td>
      <td>0.064660</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="List-of-detected-peak">List of detected peak<a class="anchor-link" href="#List-of-detected-peak"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/datasets/oco-2/peaks-detected/&#39;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;result&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/peaks-detected/result_for_oco2_1409.csv
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sounding_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>orbit</th>
      <th>slope</th>
      <th>intercept</th>
      <th>amplitude</th>
      <th>sigma</th>
      <th>delta</th>
      <th>R</th>
      <th>windspeed_u</th>
      <th>windspeed_v</th>
      <th>surface_pressure</th>
      <th>tcwv</th>
      <th>gCO2_per_s</th>
      <th>ktCO2_per_h</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2014090605011475</td>
      <td>-31.932890</td>
      <td>133.817032</td>
      <td>960</td>
      <td>-0.004587</td>
      <td>394.742035</td>
      <td>5.690958</td>
      <td>9.300781</td>
      <td>0.244105</td>
      <td>0.511300</td>
      <td>-3.204265</td>
      <td>-4.634799</td>
      <td>1005.223877</td>
      <td>8.682925</td>
      <td>382544.673873</td>
      <td>1.377161</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2014090605011533</td>
      <td>-31.880974</td>
      <td>133.827301</td>
      <td>960</td>
      <td>-0.004447</td>
      <td>394.740346</td>
      <td>3.242650</td>
      <td>9.322434</td>
      <td>0.138765</td>
      <td>0.538200</td>
      <td>-3.255919</td>
      <td>-4.609379</td>
      <td>1006.138855</td>
      <td>8.424060</td>
      <td>220272.427636</td>
      <td>0.792981</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2014090605020977</td>
      <td>-28.646854</td>
      <td>132.930969</td>
      <td>960</td>
      <td>0.003970</td>
      <td>395.016978</td>
      <td>2.381693</td>
      <td>16.881001</td>
      <td>0.056286</td>
      <td>0.525184</td>
      <td>-3.388911</td>
      <td>-2.603360</td>
      <td>987.990540</td>
      <td>10.468317</td>
      <td>143009.555556</td>
      <td>0.514834</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Level-2-sounding-value-for-a-peak">Level 2 sounding value for a peak<a class="anchor-link" href="#Level-2-sounding-value-for-a-peak"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sounding_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">sounding_id</span><span class="p">)</span>
<span class="c1">#sounding_id</span>
<span class="n">url</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_url_from_sounding_id</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">sounding_id</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/peaks-detected-details/peak_data-si_2014090605011475.json
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>orbit</th>
      <th>sounding_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>xco2</th>
      <th>xco2_uncert</th>
      <th>windspeed_u</th>
      <th>windspeed_v</th>
      <th>surface_pressure_apriori</th>
      <th>surface_pressure</th>
      <th>altitude</th>
      <th>land_water_indicator</th>
      <th>land_fraction</th>
      <th>tcwv</th>
      <th>tcwv_apriori</th>
      <th>tcwv_uncertainty</th>
      <th>latitude_orig</th>
      <th>longitude_orig</th>
      <th>distance</th>
      <th>xco2_enhancement</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>960</td>
      <td>2014090605010101</td>
      <td>-32.727406</td>
      <td>134.080856</td>
      <td>397.196472</td>
      <td>0.415720</td>
      <td>-2.145389</td>
      <td>-3.313407</td>
      <td>1011.450745</td>
      <td>1007.325317</td>
      <td>72.918121</td>
      <td>3</td>
      <td>93</td>
      <td>9.635459</td>
      <td>8.897162</td>
      <td>0.032530</td>
      <td>-32.906963</td>
      <td>134.130478</td>
      <td>-91.681727</td>
      <td>2.610016</td>
    </tr>
    <tr>
      <th>1</th>
      <td>960</td>
      <td>2014090605010534</td>
      <td>-32.485806</td>
      <td>133.978790</td>
      <td>396.806854</td>
      <td>0.352010</td>
      <td>-2.325659</td>
      <td>-3.597546</td>
      <td>1018.768433</td>
      <td>1016.415466</td>
      <td>8.619250</td>
      <td>0</td>
      <td>100</td>
      <td>10.166079</td>
      <td>9.066277</td>
      <td>0.026381</td>
      <td>-32.906963</td>
      <td>134.130478</td>
      <td>-63.262445</td>
      <td>2.220398</td>
    </tr>
    <tr>
      <th>2</th>
      <td>960</td>
      <td>2014090605010533</td>
      <td>-32.479725</td>
      <td>133.989441</td>
      <td>396.487305</td>
      <td>0.380758</td>
      <td>-2.340547</td>
      <td>-3.616978</td>
      <td>1019.266541</td>
      <td>1015.119263</td>
      <td>4.366264</td>
      <td>0</td>
      <td>100</td>
      <td>10.172779</td>
      <td>9.041010</td>
      <td>0.028613</td>
      <td>-32.906963</td>
      <td>134.130478</td>
      <td>-62.891171</td>
      <td>1.900848</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-peaks-dataset">Load peaks dataset<a class="anchor-link" href="#Load-peaks-dataset"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;/datasets/oco-2/peaks-and-invent/&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;peaks_and_invent_1804&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">datasets</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.8/site-packages/pyproj/crs/crs.py:130: FutureWarning: &#39;+init=&lt;authority&gt;:&lt;code&gt;&#39; syntax is deprecated. &#39;&lt;authority&gt;:&lt;code&gt;&#39; is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
  in_crs_string = _prepare_from_proj_string(in_crs_string)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sounding_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>orbit</th>
      <th>slope</th>
      <th>intercept</th>
      <th>amplitude</th>
      <th>sigma</th>
      <th>delta</th>
      <th>R</th>
      <th>...</th>
      <th>index_Iron and steel</th>
      <th>number_Iron and steel</th>
      <th>index_Combustion</th>
      <th>number_Combustion</th>
      <th>index_Non ferrous metals</th>
      <th>number_Non ferrous metals</th>
      <th>index_Mineral oil</th>
      <th>number_Mineral oil</th>
      <th>index_Coke ovens</th>
      <th>number_Coke ovens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018040211042706</td>
      <td>26.159534</td>
      <td>32.106270</td>
      <td>19953</td>
      <td>0.001844</td>
      <td>409.425705</td>
      <td>94.966281</td>
      <td>16.106986</td>
      <td>2.352151</td>
      <td>0.778746</td>
      <td>...</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2018040211042802</td>
      <td>26.256311</td>
      <td>32.076420</td>
      <td>19953</td>
      <td>-0.000093</td>
      <td>409.445759</td>
      <td>70.973368</td>
      <td>11.769459</td>
      <td>2.405742</td>
      <td>0.799430</td>
      <td>...</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2018042405165071</td>
      <td>-22.160683</td>
      <td>128.343689</td>
      <td>20270</td>
      <td>-0.005425</td>
      <td>404.309887</td>
      <td>53.179692</td>
      <td>10.317028</td>
      <td>2.056370</td>
      <td>0.556106</td>
      <td>...</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 48 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Load-iventory-dataset">Load iventory dataset<a class="anchor-link" href="#Load-iventory-dataset"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/dataforgoodfr/batch7_satellite_ges/master/dataset/Output</span><span class="si">%20i</span><span class="s2">nventory</span><span class="si">%20d</span><span class="s2">ata/Merge</span><span class="si">%20o</span><span class="s2">f%20peaks/CO2_emissions_peaks_merged_2018.csv&quot;</span>
<span class="n">datasets</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.8/site-packages/pyproj/crs/crs.py:130: FutureWarning: &#39;+init=&lt;authority&gt;:&lt;code&gt;&#39; syntax is deprecated. &#39;&lt;authority&gt;:&lt;code&gt;&#39; is the preferred initialization method. When making the change, be mindful of axis order changes: https://pyproj4.github.io/pyproj/stable/gotchas.html#axis-order-changes-in-proj-6
  in_crs_string = _prepare_from_proj_string(in_crs_string)
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>latitude</th>
      <th>longitude</th>
      <th>Data source</th>
      <th>CO2/CO2e emissions source</th>
      <th>CO2/CO2e emissions (in tonnes per year)</th>
      <th>CO2 or CO2e</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>43.653226</td>
      <td>-79.383184</td>
      <td>Opendatasoft</td>
      <td>City</td>
      <td>16151019.0</td>
      <td>CO2</td>
      <td>POINT (-79.38318 43.65323)</td>
    </tr>
    <tr>
      <th>4</th>
      <td>45.802578</td>
      <td>9.086356</td>
      <td>Opendatasoft</td>
      <td>City</td>
      <td>3728678.0</td>
      <td>CO2</td>
      <td>POINT (9.08636 45.80258)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>37.668900</td>
      <td>-122.080800</td>
      <td>Opendatasoft</td>
      <td>City</td>
      <td>861854.0</td>
      <td>CO2e</td>
      <td>POINT (-122.08080 37.66890)</td>
    </tr>
  </tbody>
</table>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-containers-names">Get containers names<a class="anchor-link" href="#Get-containers-names"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">container</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_containers</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Container name:&#39;</span><span class="p">,</span> <span class="n">container</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Container name: oco2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="List-files">List files<a class="anchor-link" href="#List-files"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/map/&#39;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//map/peaks_map/peaks_capture_map_2004.html&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/datasets/oco-2/inventory/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_Edgar_2015_v3.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_Edgar_2016_v3.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_Edgar_2017_v3.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_Edgar_2018_v3.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_centrale.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_coal_plant.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_peaks_merged_2016.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_peaks_merged_2017.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_peaks_merged_2018.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/CO2_emissions_peaks_merged_2019.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/cities_v1.csv&#39;,
 &#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/inventory/cities_v2.csv&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Get-files-objects">Get files objects<a class="anchor-link" href="#Get-files-objects"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">objects</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_container</span><span class="p">(</span><span class="s1">&#39;oco2&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;/datasets/oco-2/peaks-detected/&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of file : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39;oco2_1504&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="se">\t</span><span class="si">{1}</span><span class="se">\t</span><span class="si">{2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bytes&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;last_modified&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of file : 68
/datasets/oco-2/peaks-detected/result_for_oco2_1504.csv	390108	2020-05-29T06:23:55.127490
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Upload-files">Upload files<a class="anchor-link" href="#Upload-files"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">mask</span><span class="o">=</span><span class="s1">&#39;../*.md&#39;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;/Trash/&quot;</span><span class="p">,</span><span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;text/text&#39;</span><span class="p">)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/csv/*.csv&quot;, &quot;/datasets/oco-2/peaks-detected/&quot;, &#39;text/csv&#39;)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/csv/*.json&quot;, &quot;/datasets/oco-2/peaks-detected-details/&quot;, &#39;application/json&#39;)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:00<00:00]
    </div>
    


    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:00<00:00]
    </div>
    </div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="s1">&#39;/Trash/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//Trash/README.md&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Upload-HTML">Upload HTML<a class="anchor-link" href="#Upload-HTML"> </a></h3><p>Setting content type to 'text/html' allow the file to be display by browsers, without downloading.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Delete-files">Delete files<a class="anchor-link" href="#Delete-files"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">delete_files</span><span class="p">(</span><span class="s2">&quot;/Trash/&quot;</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:00<00:00]
    </div>
    


    <div>
      <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [1/1 00:00<00:00]
    </div>
    </div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="n">notebook2script</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted explorations.ipynb.
Converted index.ipynb.
Converted oco2peak-datasets-points-isoles.ipynb.
Converted oco2peak-datasets.ipynb.
Converted oco2peak-find_peak.ipynb.
Converted oco2peak-map.ipynb.
Converted oco2peak-mapfolium.ipynb.
Converted oco2peak-nc4_convert.ipynb.
Converted oco2peak-swift_utils.ipynb.
Converted oco2peak_find_source.ipynb.
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Upload-inventory">Upload inventory<a class="anchor-link" href="#Upload-inventory"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># datasets = Datasets(config)</span>
<span class="c1"># datasets.upload(mask=&#39;/media/NAS-Divers/dev/datasets/OCO2/drive-download-20200605T120938Z-001/*&#39;, prefix=&quot;/datasets/oco-2/inventory/&quot;,content_type=&#39;text/csv&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># # Re-upload raw NC4 data</span>
<span class="c1"># datasets.delete_files(prefix=&quot;/datasets/oco-2/soudings/&quot;, dry_run=False)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/csv-v10/*.bz2&quot;, &quot;/datasets/oco-2/soudings/&quot;, &#39;text/csv&#39;)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/csv-v9/*.bz2&quot;, &quot;/datasets/oco-2/soudings/&quot;, &#39;text/csv&#39;)</span>

<span class="c1"># # Re-upload all peaks</span>
<span class="c1"># datasets.delete_files(prefix=&quot;/datasets/oco-2/peaks-detected/&quot;, dry_run=False)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/peaks-v9/*.csv&quot;, &quot;/datasets/oco-2/peaks-detected/&quot;, &#39;text/csv&#39;)</span>
<span class="c1">#datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/peaks-v10/*.csv&quot;, &quot;/datasets/oco-2/peaks-detected/&quot;, &#39;text/csv&#39;)</span>

<span class="c1"># # Re-upload all JSON</span>
<span class="c1"># datasets.delete_files(prefix=&quot;/datasets/oco-2/peaks-detected-details/&quot;, dry_run=False)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/peaks-v9/*.json&quot;, &quot;/datasets/oco-2/peaks-detected-details/&quot;, &#39;application/json&#39;)</span>
<span class="c1"># datasets.upload(&quot;/media/data-nvme/dev/datasets/OCO2/peaks-v10/*.json&quot;, &quot;/datasets/oco-2/peaks-detected-details/&quot;, &#39;application/json&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">datasets</span><span class="o">.</span><span class="n">get_files_urls</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;/datasets/oco-2/peaks-and-invent/&quot;</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;peaks_and_invent&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/peaks-and-invent/peaks_and_invent_2004.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">detected_peaks_url</span> <span class="o">=</span> <span class="s2">&quot;https://storage.gra.cloud.ovh.net/v1/AUTH_2aaacef8e88a4ca897bb93b984bd04dd/oco2//datasets/oco-2/peaks-and-invent/peaks_and_invent_2004.csv&quot;</span>
<span class="n">df_oco2</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_dataframe</span><span class="p">(</span><span class="n">detected_peaks_url</span><span class="p">)</span>
<span class="n">df_oco2</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sounding_id</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>orbit</th>
      <th>slope</th>
      <th>intercept</th>
      <th>amplitude</th>
      <th>sigma</th>
      <th>delta</th>
      <th>R</th>
      <th>...</th>
      <th>index_Iron and steel</th>
      <th>number_Iron and steel</th>
      <th>index_Combustion</th>
      <th>number_Combustion</th>
      <th>index_Non ferrous metals</th>
      <th>number_Non ferrous metals</th>
      <th>index_Mineral oil</th>
      <th>number_Mineral oil</th>
      <th>index_Coke ovens</th>
      <th>number_Coke ovens</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020040111290507</td>
      <td>-13.643787</td>
      <td>33.758358</td>
      <td>30584</td>
      <td>-0.001627</td>
      <td>408.070283</td>
      <td>25.912804</td>
      <td>9.713367</td>
      <td>1.064277</td>
      <td>0.638229</td>
      <td>...</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020040111290578</td>
      <td>-13.606462</td>
      <td>33.738327</td>
      <td>30584</td>
      <td>-0.001689</td>
      <td>408.080266</td>
      <td>22.825359</td>
      <td>8.362192</td>
      <td>1.088949</td>
      <td>0.588814</td>
      <td>...</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
      <td>[nan]</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 48 columns</p>
</div></div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sounding_id</span> <span class="o">=</span> <span class="s2">&quot;2020040413511104&quot;</span>
<span class="n">peak_param_str</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_peak_param</span><span class="p">(</span><span class="n">sounding_id</span><span class="p">,</span> <span class="n">df_oco2</span><span class="p">)</span>
<span class="n">sounding_id</span> <span class="o">=</span> <span class="mi">2020040413511104</span>
<span class="n">peak_param_int64</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">get_peak_param</span><span class="p">(</span><span class="n">sounding_id</span><span class="p">,</span> <span class="n">df_oco2</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">peak_param_str</span> <span class="o">==</span> <span class="n">peak_param_int64</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>


